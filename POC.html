<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sentry Replay POC</title>

  <!-- Sentry Loader -->
  <script
    src="https://js.sentry-cdn.com/52c193564539fdeb2558e110b6a5be9b.min.js"
    crossorigin="anonymous">
  </script>

  <script>
    window.sentryOnLoad = function () {
      Sentry.init({
        dsn: "https://52c193564539fdeb2558e110b6a5be9b@o4510698684416000.ingest.us.sentry.io/4510783707348992",

        integrations: [
          Sentry.replayIntegration()
        ],

        // â¬…ï¸ Ø¯ÙˆÙ„ Ø£Ù‡Ù… Ø³Ø·Ø±ÙŠÙ†
        replaysSessionSampleRate: 1.0, // record every session
        replaysOnErrorSampleRate: 1.0, // record when error happens

        sendDefaultPii: true,
      });

      console.log("âœ… Sentry + Replay initialized");
    };
  </script>
</head>

<body>
  <h1>Sentry Session Replay â€“ POC</h1>

  <button id="test-error">Trigger Test Error</button>
  <button id="error">ğŸ”¥ Browser POC Error</button>
  <button id="attachment">ğŸ“ Error With Attachment</button>


  <script>
    document.getElementById("test-error").addEventListener("click", () => {

    // Browser POC Error button
    document.getElementById("error").addEventListener("click", () => {
      throw new Error("ğŸ”¥ Browser POC Error");
    });

    // Error with attachment button - PROPER implementation
    document.getElementById("attachment").addEventListener("click", () => {
      try {
        // Use withScope to add context and attachments
        Sentry.withScope((scope) => {
          // Add attachment to the scope
          scope.addAttachment({
            filename: 'error-context.txt',
            data: 'This is an example attachment with error context information.',
            contentType: 'text/plain',
          });

          // Add additional context
          scope.setTag('error_type', 'attachment_demo');
          scope.setContext('custom_context', {
            button_clicked: 'attachment',
            timestamp: new Date().toISOString(),
          });

          // Create and capture the error properly
          const error = new Error("ğŸ“ Error With Attachment");
          
          // Capture the exception with all the scope context and attachments
          Sentry.captureException(error);
          
          console.log("âœ… Error with attachment captured successfully");
        });
      } catch (e) {
        // Handle any errors that occur during error reporting
        console.error("Failed to capture error with attachment:", e);
        // Fallback: capture the original error without attachment
        Sentry.captureException(new Error("ğŸ“ Error With Attachment (fallback)"));
      }
    });

      throw new Error("ğŸ”¥ Replay Test Error from Browser");
    });
  </script>
</body>
</html>